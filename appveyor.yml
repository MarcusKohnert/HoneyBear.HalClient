version: 1.0.{build}
image: Visual Studio 2017
skip_tags: true
configuration: Release
platform: Any CPU
environment:
  # Don't report back to the mothership
  DOTNET_CLI_TELEMETRY_OPTOUT: 1
assembly_info:
  patch: true
  file: '**\AssemblyInfo.*'
  assembly_version: '{version}'
  assembly_file_version: '{version}'
  assembly_informational_version: '{version}'
before_build:
- msbuild -t:restore .\Src\HoneyBear.HalClient.sln
build:
  project: .\Src\HoneyBear.HalClient.sln
  verbosity: normal
after_build:
- ps: msbuild -t:pack .\Src\HoneyBear.HalClient\HoneyBear.HalClient.csproj -p:configuration=$env:CONFIGURATION -p:packageversion=$env:APPVEYOR_BUILD_VERSION -p:authors="Eoin O'Connor" -p:licenseurl=https://github.com/eoin55/HoneyBear.HalClient/blob/master/LICENSE -p:projecturl=https://github.com/eoin55/HoneyBear.HalClient -p:description="A lightweight fluent .NET client for navigating and consuming HAL APIs.  Includes support for .NET Core." -p:copyright="Copyright © Eoin O'Connor 2017" -p:packagetags="HAL JSON Hypermedia HATEOAS REST DotNetCore" -p:packageoutputpath=$pwd\artifacts
after_test:
- cmd: >-
    %USERPROFILE%\.nuget\packages\OpenCover\4.6.519\tools\OpenCover.Console.exe -register:user -filter:"+[HoneyBear.HalClient]*" -target:"%USERPROFILE%\.nuget\packages\NUnit.ConsoleRunner\3.6.1\tools\nunit3-console.exe" -targetargs:".\Src\HoneyBear.HalClient.Unit.Tests\bin\%CONFIGURATION%\net452\HoneyBear.HalClient.Unit.Tests.dll" -output:coverage.xml

    %USERPROFILE%\.nuget\packages\coveralls.io\1.3.4\tools\coveralls.net.exe --opencover coverage.xml --repo-token hOBugtrP7A2crVX8BA0cT9E8GjnlK8bcP
deploy: off
artifacts:
- path: .\artifacts\*.nupkg